import { Blob } from '@aztec/blob-lib';
import { EthAddress } from '@aztec/foundation/eth-address';
import { L1TxUtils } from './l1_tx_utils.js';
import { createViemSigner } from './signer.js';
/** Extends L1TxUtils with the capability to cancel blobs. This needs to be a separate class so we don't require a dependency on blob-lib unnecessarily. */ export class L1TxUtilsWithBlobs extends L1TxUtils {
    /** Makes empty blob inputs for the cancellation tx. */ makeEmptyBlobInputs(maxFeePerBlobGas) {
        const blobData = new Uint8Array(131072).fill(0);
        const kzg = Blob.getViemKzgInstance();
        return {
            blobs: [
                blobData
            ],
            kzg,
            maxFeePerBlobGas
        };
    }
}
export function createL1TxUtilsWithBlobsFromViemWallet(client, deps = {}, config = {}, debugMaxGasLimit = false) {
    return new L1TxUtilsWithBlobs(client, EthAddress.fromString(client.account.address), createViemSigner(client), deps.logger, deps.dateProvider, config, debugMaxGasLimit, deps.store, deps.metrics);
}
export function createL1TxUtilsWithBlobsFromEthSigner(client, signer, deps = {}, config = {}, debugMaxGasLimit = false) {
    const callback = async (transaction, _signingAddress)=>{
        return (await signer.signTransaction(transaction)).toViemTransactionSignature();
    };
    return new L1TxUtilsWithBlobs(client, signer.address, callback, deps.logger, deps.dateProvider, config, debugMaxGasLimit, deps.store, deps.metrics);
}
