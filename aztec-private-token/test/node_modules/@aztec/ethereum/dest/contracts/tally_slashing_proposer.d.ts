import { type L1TxRequest, type ViemClient } from '@aztec/ethereum';
import { Buffer32 } from '@aztec/foundation/buffer';
import { EthAddress } from '@aztec/foundation/eth-address';
import { type Hex, type Log, type TypedDataDefinition } from 'viem';
/**
 * Wrapper around the TallySlashingProposer contract that provides
 * a TypeScript interface for interacting with the consensus-based slashing system.
 */
export declare class TallySlashingProposerContract {
    readonly client: ViemClient;
    private readonly contract;
    readonly type: "tally";
    constructor(client: ViemClient, address: Hex | EthAddress);
    get address(): EthAddress;
    getQuorumSize(): Promise<bigint>;
    getRoundSize(): Promise<bigint>;
    getCommitteeSize(): Promise<bigint>;
    getRoundSizeInEpochs(): Promise<bigint>;
    getLifetimeInRounds(): Promise<bigint>;
    getExecutionDelayInRounds(): Promise<bigint>;
    getSlashingAmounts(): Promise<[bigint, bigint, bigint]>;
    getSlashOffsetInRounds(): Promise<bigint>;
    getCurrentRound(): Promise<bigint>;
    /**
     * Get round information
     * @param round - The round number to query
     * @returns Round status information
     */
    getRound(round: bigint): Promise<{
        isExecuted: boolean;
        readyToExecute: boolean;
        voteCount: bigint;
    }>;
    /** Returns the slash actions and payload address for a given round (zero if no slash actions) */
    getPayload(round: bigint): Promise<{
        actions: {
            slashAmount: bigint;
            validator: EthAddress;
        }[];
        address: EthAddress;
    }>;
    /** Returns the slash actions to be executed for a given round based on votes */
    getTally(round: bigint): Promise<{
        actions: {
            slashAmount: bigint;
            validator: EthAddress;
        }[];
        committees: EthAddress[][];
    }>;
    private mapSlashActions;
    /** Tries to extract a VoteCast event from the given logs. */
    tryExtractVoteCastEvent(logs: Log[]): {
        eventName: "VoteCast";
        args: {
            round: bigint;
            slot: bigint;
            proposer: `0x${string}`;
        };
    } | undefined;
    /** Tries to extract a RoundExecuted event from the given logs. */
    tryExtractRoundExecutedEvent(logs: Log[]): {
        eventName: "RoundExecuted";
        args: {
            round: bigint;
            slashCount: bigint;
        };
    } | undefined;
    /**
     * Create a transaction to vote for slashing offenses
     * @param votes - The encoded votes for slashing
     * @param slot - The slot number for the vote
     * @param signer - The signer to produce the signature
     * @returns L1 transaction request
     */
    buildVoteRequestFromSigner(votes: Hex, slot: bigint, signer: (msg: TypedDataDefinition) => Promise<Hex>): Promise<L1TxRequest>;
    /** Returns the typed data definition to EIP712-sign for voting */
    buildVoteTypedData(votes: Hex, slot: bigint): TypedDataDefinition;
    /** Gets the digest to sign for voting directly from the contract */
    getVoteDataDigest(votes: Hex, slot: bigint): Promise<Buffer32>;
    /**
     * Create a transaction to vote for slashing offenses
     * @param votes - The encoded votes for slashing
     * @param signature - The signature from the current proposer
     * @returns L1 transaction request
     */
    buildVoteRequestWithSignature(votes: Hex, signature: {
        v: number;
        r: Hex;
        s: Hex;
    }): L1TxRequest;
    /**
     * Create a transaction to execute a slashing round
     * @param round - The round number to execute
     * @param committees - The committees for each epoch in the round
     * @returns L1 transaction request
     */
    buildExecuteRoundRequest(round: bigint, committees: EthAddress[][]): L1TxRequest;
    /** Returns the last vote emitted for a given round  */
    getLastVote(round: bigint): Promise<{
        validator: EthAddress;
        slashAmount: bigint;
    }[]>;
    /**
     * Listen for VoteCast events
     * @param callback - Callback function to handle vote cast events
     * @returns Unwatch function
     */
    listenToVoteCast(callback: (args: {
        round: bigint;
        proposer: string;
    }) => void): () => void;
    /**
     * Listen for RoundExecuted events
     * @param callback - Callback function to handle round executed events
     * @returns Unwatch function
     */
    listenToRoundExecuted(callback: (args: {
        round: bigint;
        slashCount: bigint;
        l1BlockHash: Hex;
    }) => void): () => void;
}
/**
 * Decodes a Buffer containing slash votes back into an array of numbers.
 * Each vote is represented as a 2-bit value (0, 1, 2, or 3) representing slashing units.
 * @dev This should live in stdlib next to encodeSlashConsensusVotes but is here since we
 * do not have a dependency to stdlib from the ethereum package. We need a larger refactor to fix this.
 * @param buffer - The Buffer containing encoded slash votes
 * @returns An array of numbers representing the slash votes
 */
export declare function decodeSlashConsensusVotes(buffer: Buffer): number[];
//# sourceMappingURL=tally_slashing_proposer.d.ts.map