import { z } from 'zod';
/**
 * BN254 Keystore Format
 *
 * Implements encryption and decryption of keystores for BN254 BLS private keys
 * using PBKDF2 and AES-128-CTR. This format is inspired by EIP-2335 but adapted
 * for BN254 keys rather than BLS12-381.
 *
 * @see https://eips.ethereum.org/EIPS/eip-2335
 */
/**
 * Zod schema for validating BN254 keystore structure
 */
declare const bn254KeystoreSchema: z.ZodObject<{
    crypto: z.ZodObject<{
        kdf: z.ZodObject<{
            function: z.ZodLiteral<"pbkdf2">;
            params: z.ZodObject<{
                dklen: z.ZodNumber;
                c: z.ZodNumber;
                prf: z.ZodString;
                salt: z.ZodString;
            }, "strip", z.ZodTypeAny, {
                c: number;
                dklen: number;
                prf: string;
                salt: string;
            }, {
                c: number;
                dklen: number;
                prf: string;
                salt: string;
            }>;
            message: z.ZodString;
        }, "strip", z.ZodTypeAny, {
            function: "pbkdf2";
            params: {
                c: number;
                dklen: number;
                prf: string;
                salt: string;
            };
            message: string;
        }, {
            function: "pbkdf2";
            params: {
                c: number;
                dklen: number;
                prf: string;
                salt: string;
            };
            message: string;
        }>;
        checksum: z.ZodObject<{
            function: z.ZodLiteral<"sha256">;
            params: z.ZodObject<{}, "strip", z.ZodTypeAny, {}, {}>;
            message: z.ZodString;
        }, "strip", z.ZodTypeAny, {
            function: "sha256";
            params: {};
            message: string;
        }, {
            function: "sha256";
            params: {};
            message: string;
        }>;
        cipher: z.ZodObject<{
            function: z.ZodLiteral<"aes-128-ctr">;
            params: z.ZodObject<{
                iv: z.ZodString;
            }, "strip", z.ZodTypeAny, {
                iv: string;
            }, {
                iv: string;
            }>;
            message: z.ZodString;
        }, "strip", z.ZodTypeAny, {
            function: "aes-128-ctr";
            params: {
                iv: string;
            };
            message: string;
        }, {
            function: "aes-128-ctr";
            params: {
                iv: string;
            };
            message: string;
        }>;
    }, "strip", z.ZodTypeAny, {
        kdf: {
            function: "pbkdf2";
            params: {
                c: number;
                dklen: number;
                prf: string;
                salt: string;
            };
            message: string;
        };
        checksum: {
            function: "sha256";
            params: {};
            message: string;
        };
        cipher: {
            function: "aes-128-ctr";
            params: {
                iv: string;
            };
            message: string;
        };
    }, {
        kdf: {
            function: "pbkdf2";
            params: {
                c: number;
                dklen: number;
                prf: string;
                salt: string;
            };
            message: string;
        };
        checksum: {
            function: "sha256";
            params: {};
            message: string;
        };
        cipher: {
            function: "aes-128-ctr";
            params: {
                iv: string;
            };
            message: string;
        };
    }>;
    description: z.ZodOptional<z.ZodString>;
    pubkey: z.ZodString;
    path: z.ZodString;
    uuid: z.ZodString;
    version: z.ZodNumber;
}, "strip", z.ZodTypeAny, {
    path: string;
    version: number;
    crypto: {
        kdf: {
            function: "pbkdf2";
            params: {
                c: number;
                dklen: number;
                prf: string;
                salt: string;
            };
            message: string;
        };
        checksum: {
            function: "sha256";
            params: {};
            message: string;
        };
        cipher: {
            function: "aes-128-ctr";
            params: {
                iv: string;
            };
            message: string;
        };
    };
    pubkey: string;
    uuid: string;
    description?: string | undefined;
}, {
    path: string;
    version: number;
    crypto: {
        kdf: {
            function: "pbkdf2";
            params: {
                c: number;
                dklen: number;
                prf: string;
                salt: string;
            };
            message: string;
        };
        checksum: {
            function: "sha256";
            params: {};
            message: string;
        };
        cipher: {
            function: "aes-128-ctr";
            params: {
                iv: string;
            };
            message: string;
        };
    };
    pubkey: string;
    uuid: string;
    description?: string | undefined;
}>;
/**
 * Error thrown when BN254 keystore operations fail
 */
export declare class Bn254KeystoreError extends Error {
    cause?: Error | undefined;
    constructor(message: string, cause?: Error | undefined);
}
export type Bn254Keystore = z.infer<typeof bn254KeystoreSchema>;
/**
 * The JSON structure of a BN254 keystore file.
 * @deprecated Use the inferred type from bn254KeystoreSchema instead
 */
export interface Bn254KeystoreInterface {
    crypto: {
        kdf: {
            function: 'pbkdf2';
            params: {
                dklen: number;
                c: number;
                prf: string;
                salt: string;
            };
            message: string;
        };
        checksum: {
            function: 'sha256';
            params: Record<string, never>;
            message: string;
        };
        cipher: {
            function: 'aes-128-ctr';
            params: {
                iv: string;
            };
            message: string;
        };
    };
    description: string;
    pubkey: string;
    path: string;
    uuid: string;
    version: number;
}
/**
 * Creates a BN254 keystore object for a BN254 BLS private key.
 *
 * Uses PBKDF2 with SHA-256 for key derivation and AES-128-CTR for encryption,
 * following the EIP-2335 specification format.
 *
 * @param password - Password for encrypting the private key
 * @param privateKeyHex - Private key as 0x-prefixed hex string (32 bytes)
 * @param pubkeyHex - Public key as hex string (compressed or uncompressed)
 * @param derivationPath - BIP-44 style derivation path (e.g., "m/12381/3600/0/0/0")
 * @returns BN254 keystore object ready to be serialized to JSON
 * @throws Error if private key is not 32-byte hex
 */
export declare function createBn254Keystore(password: string, privateKeyHex: string, pubkeyHex: string, derivationPath: string): Bn254Keystore;
/**
 * Loads and validates a BN254 keystore file.
 *
 * @param filePath - Path to the BN254 keystore JSON file
 * @returns Validated keystore object
 * @throws Bn254KeystoreError if file cannot be read or validated
 */
export declare function loadBn254Keystore(filePath: string): Bn254Keystore;
/**
 * Decrypts a BN254 BLS private key from a keystore file.
 *
 * @param filePath - Path to the BN254 keystore JSON file
 * @param password - Password to decrypt the keystore
 * @returns Decrypted private key as 0x-prefixed hex string (32 bytes)
 * @throws Bn254KeystoreError if decryption fails or checksum is invalid
 */
export declare function decryptBn254Keystore(filePath: string, password: string): string;
/**
 * Decrypts a BN254 BLS private key from a keystore object.
 *
 * @param keystore - BN254 keystore object
 * @param password - Password to decrypt the keystore
 * @returns Decrypted private key as 0x-prefixed hex string (32 bytes)
 * @throws Bn254KeystoreError if decryption fails or checksum is invalid
 */
export declare function decryptBn254KeystoreFromObject(keystore: Bn254Keystore, password: string): string;
/**
 * Validates that a decrypted private key matches the public key in the keystore.
 *
 * @param privateKeyHex - Decrypted private key (0x-prefixed)
 * @param expectedPubkey - Expected public key from keystore
 * @param computePublicKey - Function to compute public key from private key
 * @returns true if keys match, false otherwise
 */
export declare function verifyBn254Keypair(privateKeyHex: string, expectedPubkey: string, computePublicKey: (privateKey: string) => string): boolean;
export {};
//# sourceMappingURL=bn254_keystore.d.ts.map