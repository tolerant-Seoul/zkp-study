# 1.3 ZKP 적용 사례와 응용 분야

## 개요

Zero-Knowledge Proof는 이론적 암호학 개념에서 시작하여 현재 다양한 실제 응용 분야에서 활용되고 있다. 이 문서에서는 ZKP의 주요 적용 사례를 분류하고, 각 분야에서 ZKP가 어떻게 문제를 해결하는지 살펴본다.

---

## 1. 블록체인 확장성 (Scalability)

### 1.1 문제 정의

```
블록체인의 확장성 딜레마:

기존 블록체인 (예: Ethereum):
- 모든 노드가 모든 트랜잭션을 실행
- 처리량 제한 (Ethereum: ~15 TPS)
- 가스 비용 증가

목표:
- 처리량 증가 (1000+ TPS)
- 비용 감소
- 보안 유지
```

### 1.2 ZK-Rollup

ZK-Rollup은 수천 개의 트랜잭션을 오프체인에서 처리하고, 그 결과의 유효성을 ZKP로 증명하여 메인체인에 제출하는 Layer 2 솔루션이다.

```
ZK-Rollup 구조:

┌─────────────────────────────────────────────────────────────────┐
│                        Layer 1 (Ethereum)                       │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  Rollup Contract                                         │   │
│  │  - State Root 저장                                        │   │
│  │  - ZK Proof 검증                                          │   │
│  │  - 자산 예치/인출 관리                                    │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              ^
                              |  (State Root + ZK Proof)
                              |
┌─────────────────────────────────────────────────────────────────┐
│                        Layer 2 (Off-chain)                      │
│                                                                 │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐                  │
│  │   Tx 1   │    │   Tx 2   │    │  Tx 3-N  │                  │
│  └────┬─────┘    └────┬─────┘    └────┬─────┘                  │
│       └───────────────┴───────────────┘                        │
│                       |                                         │
│                       v                                         │
│              ┌─────────────────┐                               │
│              │    Sequencer    │                               │
│              │  (트랜잭션 정렬) │                               │
│              └────────┬────────┘                               │
│                       v                                         │
│              ┌─────────────────┐                               │
│              │     Prover      │                               │
│              │ (ZK Proof 생성) │                               │
│              └─────────────────┘                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 1.3 ZK Proof가 증명하는 것

```
ZK-Rollup의 Validity Proof:

증명 내용:
1. 모든 트랜잭션이 유효한 서명을 가짐
2. 각 계정의 nonce가 올바르게 증가함
3. 잔액 변경이 올바름 (보내는 금액 <= 보유 잔액)
4. 상태 전이가 올바름 (State_old -> State_new)

결과:
- L1에서 개별 트랜잭션 검증 불필요
- 단일 ZK Proof 검증으로 수천 개 트랜잭션 유효성 확인
- Gas 비용 대폭 감소
```

### 1.4 주요 프로젝트

| 프로젝트 | 증명 시스템 | 특징 |
|---------|------------|------|
| zkSync | PLONK 기반 | EVM 호환, 범용 스마트 컨트랙트 |
| StarkNet | STARK | Cairo 언어, 양자 내성 |
| Polygon zkEVM | SNARK | 완전한 EVM 호환성 |
| Scroll | SNARK | 바이트코드 레벨 EVM 호환 |
| Linea | SNARK | ConsenSys 개발 |

---

## 2. 프라이버시 보호 (Privacy)

### 2.1 문제 정의

```
블록체인 투명성의 문제:

공개 블록체인:
- 모든 트랜잭션이 공개됨
- 주소 연결 분석으로 신원 추적 가능
- 금융 프라이버시 없음

필요:
- 트랜잭션 세부사항 숨김
- 규제 준수 가능성 유지
- 검증 가능성 유지
```

### 2.2 프라이빗 트랜잭션

#### Zcash

```
Zcash Shielded Transaction:

공개 정보:
- 트랜잭션 존재
- ZK Proof (유효성 증명)

숨겨진 정보:
- 송신자
- 수신자
- 금액

ZK Proof가 증명하는 것:
1. 송신자가 소비할 노트를 소유함
2. 노트가 이전에 소비되지 않음 (nullifier 체크)
3. 입력 총합 = 출력 총합 (토큰 보존)
4. 새 노트의 commitment가 올바름
```

#### Aztec

```
Aztec의 프라이버시 레이어:

특징:
- Ethereum 위의 프라이빗 스마트 컨트랙트
- Noir 언어로 프라이빗 로직 작성
- Viewing Key로 선택적 공개

예시: 프라이빗 토큰 전송
┌─────────────────────────────────────────────────────────────────┐
│  공개 상태                          프라이빗 상태               │
│  ┌─────────────────┐               ┌─────────────────┐         │
│  │ - 컨트랙트 주소  │               │ - 잔액 (암호화)  │         │
│  │ - 총 발행량     │               │ - 소유자 (암호화)│         │
│  │ - ZK Proofs    │               │ - 전송 내역     │         │
│  └─────────────────┘               └─────────────────┘         │
└─────────────────────────────────────────────────────────────────┘
```

### 2.3 프라이빗 DeFi

```
문제: DeFi의 투명성

현재 DeFi:
- 모든 포지션이 공개됨
- MEV (Miner Extractable Value) 공격 취약
- 청산 사냥 가능
- 거래 전략 노출

ZKP 해결책:
- 프라이빗 거래소 (Dark Pool)
- 숨겨진 주문서
- 프라이빗 대출/차입
- MEV 방지
```

---

## 3. 신원 인증 (Identity)

### 3.1 문제 정의

```
현재 신원 인증의 문제:

전통적 방식:
- 신분증 전체 공개
- 불필요한 정보 노출
- 개인정보 유출 위험

예시: 술집에서 나이 확인
- 현재: 주민등록증 전체 노출 (이름, 주소, 주민번호 등)
- 원하는 것: "18세 이상이다" 사실만 증명
```

### 3.2 선택적 공개 (Selective Disclosure)

```
ZKP 기반 신원 인증:

┌─────────────────────────────────────────────────────────────────┐
│                    신원 증명서 (암호화)                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  이름: 홍길동                                            │   │
│  │  생년월일: 1995-03-15                                   │   │
│  │  주소: 서울시 ...                                        │   │
│  │  주민등록번호: 950315-1******                           │   │
│  │  발급기관 서명: [정부 서명]                              │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              |
                              v
┌─────────────────────────────────────────────────────────────────┐
│                    ZK Proof 생성                                │
│                                                                 │
│  증명 요청: "18세 이상인가?"                                    │
│                                                                 │
│  ZK Proof 출력:                                                 │
│  - "이 사람은 18세 이상이다" (참/거짓)                          │
│  - 증명서가 유효한 정부 서명을 가짐                              │
│                                                                 │
│  노출되지 않는 정보:                                            │
│  - 정확한 나이                                                  │
│  - 이름                                                         │
│  - 주소                                                         │
│  - 기타 모든 개인정보                                           │
└─────────────────────────────────────────────────────────────────┘
```

### 3.3 주요 프로젝트

| 프로젝트 | 설명 | 사용 사례 |
|---------|------|----------|
| Polygon ID | 탈중앙화 신원 관리 | KYC, 나이 인증, 자격 증명 |
| WorldCoin | 생체 인증 기반 신원 | 유니크한 인간임 증명 |
| Sismo | 프라이빗 증명 배지 | 멤버십 증명 |
| Semaphore | 익명 신호 시스템 | 익명 투표, 휘슬블로잉 |

### 3.4 예시: Semaphore Protocol

```
Semaphore: 익명 그룹 멤버십 증명

사용 사례: 익명 투표

1. 그룹 등록
   - 사용자가 비밀키 생성
   - 공개키(identity commitment)를 Merkle Tree에 추가
   - 그룹 멤버로 등록됨

2. 익명 투표
   ┌─────────────────────────────────────────────────────────┐
   │  ZK Proof 생성:                                         │
   │  - "나는 이 그룹의 멤버이다"                              │
   │  - "이 nullifier로 이전에 투표하지 않았다"                │
   │  - "나의 투표는 X이다"                                   │
   │                                                         │
   │  노출되지 않는 것:                                       │
   │  - 나의 identity                                        │
   │  - 그룹 내 어떤 멤버인지                                 │
   └─────────────────────────────────────────────────────────┘

3. 검증
   - ZK Proof 검증
   - Nullifier 중복 체크 (이중 투표 방지)
   - 투표 집계
```

---

## 4. 탈중앙화 금융 (DeFi) 응용

### 4.1 프라이빗 거래

```
Dark Pool (프라이빗 거래소):

문제:
- 대량 주문이 시장에 영향
- Front-running 공격
- 거래 전략 노출

ZKP 해결책:
┌─────────────────────────────────────────────────────────────────┐
│                    프라이빗 주문 매칭                            │
│                                                                 │
│  주문 A (암호화):                                               │
│  - 매수 100 ETH @ $2000 이하                                   │
│                                                                 │
│  주문 B (암호화):                                               │
│  - 매도 80 ETH @ $1950 이상                                    │
│                                                                 │
│  ZK Proof:                                                      │
│  - "매칭 가능한 주문이 존재한다"                                 │
│  - "매칭 가격은 $1975이다"                                      │
│  - "수량은 80 ETH이다"                                          │
│                                                                 │
│  노출되지 않는 것:                                               │
│  - 전체 주문 크기                                               │
│  - 거래자 신원                                                  │
│  - 남은 주문                                                    │
└─────────────────────────────────────────────────────────────────┘
```

### 4.2 프라이빗 대출

```
담보 대출 프라이버시:

현재 DeFi 대출:
- 담보 금액 공개
- 대출 금액 공개
- 청산 가격 계산 가능
- 청산 사냥 가능

ZKP 해결책:
┌─────────────────────────────────────────────────────────────────┐
│  ZK Proof가 증명하는 것:                                        │
│                                                                 │
│  1. "담보 비율이 150% 이상이다"                                 │
│  2. "대출 상환 능력이 있다"                                     │
│  3. "담보가 유효한 자산이다"                                    │
│                                                                 │
│  노출되지 않는 것:                                               │
│  - 정확한 담보 금액                                             │
│  - 정확한 대출 금액                                             │
│  - 청산 가격                                                    │
└─────────────────────────────────────────────────────────────────┘
```

### 4.3 규제 준수 (Compliance)

```
프라이버시와 규제의 균형:

문제:
- 완전한 익명성은 규제 불가
- 완전한 투명성은 프라이버시 침해

ZKP 해결책: 선택적 공개
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  일반 사용자에게: 완전한 프라이버시                              │
│  - 트랜잭션 세부사항 비공개                                     │
│                                                                 │
│  규제기관에게 (Viewing Key 제공):                               │
│  - 필요한 정보만 선택적 공개                                    │
│  - 예: 일정 금액 이상 거래만                                    │
│  - 예: 특정 기간 거래만                                         │
│                                                                 │
│  ZK Proof로 증명:                                               │
│  - "AML/KYC 인증을 받은 사용자이다"                             │
│  - "제재 대상이 아니다"                                         │
│  - "거래 한도를 초과하지 않았다"                                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. 게임과 무결성 증명

### 5.1 온체인 게임

```
불완전 정보 게임:

문제:
- 블록체인은 모든 것이 공개됨
- 포커, 전략 게임 등에서 패 공개 불가
- 숨겨진 정보가 필요한 게임 구현 어려움

ZKP 해결책:
┌─────────────────────────────────────────────────────────────────┐
│                    ZK 포커 예시                                  │
│                                                                 │
│  1. 카드 분배 (암호화)                                          │
│     - 각 플레이어가 자신의 카드만 볼 수 있음                     │
│     - 딜러도 개별 카드 알 수 없음                               │
│                                                                 │
│  2. 베팅 라운드                                                 │
│     - 베팅 금액만 공개                                          │
│     - 카드 정보는 비공개                                        │
│                                                                 │
│  3. 쇼다운                                                      │
│     - ZK Proof로 패 공개 없이 승자 결정                         │
│     - "나의 패가 상대보다 높다"                                  │
│     - 또는 선택적으로 패 공개                                    │
│                                                                 │
│  4. 검증                                                        │
│     - 초기 셔플이 공정했음 증명                                  │
│     - 게임 규칙이 올바르게 적용됐음 증명                         │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 Dark Forest

```
Dark Forest: ZK 기반 전략 게임

게임 개념:
- 우주 탐험 전략 게임
- 행성 위치가 숨겨짐
- 탐험을 통해 발견

ZK 적용:
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  플레이어 행동:                                                  │
│  1. 행성 A에서 행성 B로 함대 이동                               │
│                                                                 │
│  ZK Proof 제출:                                                 │
│  - "나는 행성 A를 소유한다"                                      │
│  - "행성 A와 B의 거리는 X이다"                                   │
│  - "이동 시간은 Y이다"                                          │
│                                                                 │
│  숨겨진 정보:                                                    │
│  - 행성 A의 정확한 좌표                                         │
│  - 행성 B의 정확한 좌표                                         │
│  - 함대 크기 (옵션)                                             │
│                                                                 │
│  결과:                                                          │
│  - 전략적 불확실성 유지                                         │
│  - 게임 규칙 온체인 검증                                        │
│  - 치팅 불가                                                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. 머신러닝과 AI

### 6.1 zkML (Zero-Knowledge Machine Learning)

```
문제:
- ML 모델의 무결성 증명
- 추론 결과가 특정 모델에서 나왔음 증명
- 모델 가중치 비공개 유지

응용:
┌─────────────────────────────────────────────────────────────────┐
│                    zkML 사용 사례                                │
│                                                                 │
│  1. 모델 추론 증명                                               │
│     - "이 이미지 분류 결과는 모델 M에서 나왔다"                  │
│     - 모델 M의 가중치는 비공개                                   │
│                                                                 │
│  2. 공정한 AI 증명                                               │
│     - "이 모델은 특정 속성에 대해 편향되지 않았다"               │
│     - 학습 데이터 비공개                                         │
│                                                                 │
│  3. 프라이빗 추론                                                │
│     - 사용자 입력 데이터 비공개                                  │
│     - 모델 가중치 비공개                                         │
│     - 결과만 공개                                                │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 6.2 주요 프로젝트

| 프로젝트 | 설명 | 접근 방식 |
|---------|------|----------|
| EZKL | PyTorch 모델을 ZK 회로로 변환 | SNARK 기반 |
| Modulus Labs | zkML 인프라 | 최적화된 증명 시스템 |
| Giza | ML 모델 검증 | Cairo/STARK 기반 |

---

## 7. 오라클과 데이터 증명

### 7.1 데이터 무결성 증명

```
문제:
- 오프체인 데이터를 온체인에서 신뢰
- 데이터 소스의 무결성 검증
- 민감한 데이터 비공개 유지

ZKP 해결책:
┌─────────────────────────────────────────────────────────────────┐
│                    ZK 오라클                                     │
│                                                                 │
│  데이터 소스 (예: 거래소 API)                                    │
│       |                                                         │
│       v                                                         │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  ZK Proof 생성                                           │   │
│  │  - "이 가격 데이터는 거래소 X에서 왔다"                   │   │
│  │  - "데이터 시간은 T이다"                                  │   │
│  │  - "서명이 유효하다"                                      │   │
│  └─────────────────────────────────────────────────────────┘   │
│       |                                                         │
│       v                                                         │
│  온체인 검증                                                     │
│  - ZK Proof 검증                                                │
│  - 데이터 사용                                                  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 7.2 TLS 검증 (Web Proofs)

```
TLSNotary / Web Proofs:

개념:
- HTTPS 통신 내용을 ZK로 증명
- 웹사이트 데이터의 진위 증명
- 민감한 부분은 숨김

예시: 은행 잔고 증명
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  1. 사용자가 은행 웹사이트 접속                                  │
│  2. TLS 세션 데이터 캡처                                        │
│  3. ZK Proof 생성:                                              │
│     - "이 데이터는 bank.com에서 왔다"                           │
│     - "잔고가 $10,000 이상이다"                                 │
│                                                                 │
│  숨겨진 정보:                                                    │
│  - 정확한 잔고                                                  │
│  - 계좌번호                                                     │
│  - 거래 내역                                                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 8. 분야별 정리

### 8.1 적용 분야 매트릭스

| 분야 | 핵심 문제 | ZKP 해결 방식 | 대표 프로젝트 |
|------|----------|--------------|--------------|
| 확장성 | 처리량 한계 | Validity Proof | zkSync, StarkNet |
| 프라이버시 | 거래 정보 노출 | 암호화 + ZKP | Aztec, Zcash |
| 신원 인증 | 과도한 정보 노출 | 선택적 공개 | Polygon ID |
| DeFi | MEV, 프라이버시 | 숨겨진 주문 | Dark Pool |
| 게임 | 불완전 정보 | 숨겨진 상태 | Dark Forest |
| AI/ML | 모델 무결성 | 추론 증명 | EZKL |
| 오라클 | 데이터 신뢰 | 출처 증명 | TLSNotary |

### 8.2 ZKP가 해결하는 핵심 문제

```
1. 검증 비용 절감
   - 복잡한 계산을 오프체인에서 수행
   - 단순한 증명 검증만 온체인에서

2. 프라이버시 보존
   - 필요한 사실만 증명
   - 세부 정보 비공개

3. 신뢰 최소화
   - 제3자 신뢰 불필요
   - 수학적 보장

4. 규제 호환성
   - 선택적 공개로 규제 준수
   - 프라이버시와 규제의 균형
```

---

## 9. 실습 과제

### 과제 1: ZK-Rollup 이해

```
문제:
1000개의 토큰 전송 트랜잭션이 있다고 가정하자.

질문:
1. 기존 Ethereum에서 각 트랜잭션 가스 비용이 21,000이라면 총 비용은?
2. ZK-Rollup에서 증명 검증 비용이 500,000 가스이고,
   calldata 비용이 트랜잭션당 16 가스라면 총 비용은?
3. 비용 절감률은 얼마인가?

답:
1. 21,000 * 1000 = 21,000,000 가스
2. 500,000 + (16 * 1000) = 516,000 가스
3. 절감률 = (21,000,000 - 516,000) / 21,000,000 = 97.5%
```

### 과제 2: 선택적 공개 설계

```
시나리오:
온라인 주류 판매 사이트에서 나이 인증이 필요하다.

요구사항:
- 구매자가 19세 이상임을 증명
- 정확한 생년월일 노출 금지
- 이름, 주소 등 개인정보 노출 금지

설계:
1. 어떤 정보가 ZK Proof에 포함되어야 하는가?
2. 어떤 정보가 증명서에 있어야 하는가?
3. 검증자는 무엇을 확인하는가?

답:
1. ZK Proof 내용:
   - "생년월일이 현재 날짜로부터 19년 이전이다"
   - "증명서 서명이 유효하다"

2. 증명서 (암호화):
   - 생년월일
   - 정부 서명

3. 검증자 확인:
   - ZK Proof 유효성
   - 증명이 최근에 생성됨 (리플레이 방지)
```

---

## 10. 요약

```
ZKP 적용 분야 핵심 정리:

1. 블록체인 확장성
   - ZK-Rollup으로 처리량 1000배 이상 향상
   - 가스 비용 90% 이상 절감

2. 프라이버시
   - 거래 정보 완전 비공개 가능
   - 선택적 공개로 규제 준수

3. 신원 인증
   - 필요한 속성만 증명 (나이, 자격 등)
   - 개인정보 보호

4. 게임/AI
   - 불완전 정보 게임 온체인 구현
   - ML 모델 무결성 증명

5. 공통 패턴
   - 오프체인 계산 + 온체인 검증
   - 프라이버시 보존 + 무결성 보장
   - 신뢰 최소화
```

---

## 참고 자료

### 공식 문서
- https://docs.zksync.io - zkSync 문서
- https://docs.starknet.io - StarkNet 문서
- https://docs.aztec.network - Aztec 문서
- https://z.cash/technology - Zcash 기술 문서

### 학습 자료
- https://github.com/matter-labs/awesome-zero-knowledge-proofs
- https://learn.0xparc.org - 0xPARC 학습 자료
- https://zkhack.dev - ZK Hack 튜토리얼

### 프로젝트
- https://github.com/semaphore-protocol/semaphore
- https://github.com/darkforest-eth/darkforest
- https://github.com/zkonduit/ezkl
