# 1.1 ZKP 핵심 개념: Completeness, Soundness, Zero-Knowledge

## 개요

Zero-Knowledge Proof(ZKP)는 한 당사자(Prover, 증명자)가 다른 당사자(Verifier, 검증자)에게 어떤 명제가 참임을 증명하면서, 그 명제가 참이라는 사실 외에는 어떠한 정보도 노출하지 않는 암호학적 기법이다.

ZKP가 유효하기 위해서는 세 가지 핵심 속성을 만족해야 한다:
1. Completeness (완전성)
2. Soundness (건전성)
3. Zero-Knowledge (영지식성)

---

## 1. Completeness (완전성)

### 1.1 정의

완전성은 "정직한 증명자가 참인 명제를 증명하면, 정직한 검증자는 항상 그 증명을 받아들인다"는 속성이다.

```
수학적 표현:
만약 x가 언어 L에 속하고, P(증명자)가 유효한 witness w를 알고 있다면,
V(검증자)는 항상 "Accept"를 출력한다.

Pr[V(x, P(x, w)) = Accept | x in L] = 1 (또는 1 - negligible)
```

### 1.2 직관적 이해

- 진실을 말하는 사람은 항상 자신의 주장을 증명할 수 있어야 한다
- 시스템이 제대로 동작한다면, 정당한 증명은 거부되지 않아야 한다
- 거짓 양성(false positive rejection)이 없어야 한다

### 1.3 예시

```
시나리오: 비밀번호 증명

- Alice는 비밀번호 "secret123"을 알고 있다
- 시스템의 해시값은 H("secret123")이다
- Alice가 올바른 비밀번호를 가지고 증명을 생성하면,
  검증자는 항상 이 증명을 수락해야 한다

완전성 위반 예시:
- 버그로 인해 올바른 비밀번호로도 증명이 실패하는 경우
- 시스템 오류로 정당한 사용자가 거부되는 경우
```

### 1.4 Perfect vs Statistical Completeness

| 유형 | 성공 확률 | 설명 |
|------|-----------|------|
| Perfect Completeness | 100% | 정직한 증명은 항상 수락됨 |
| Statistical Completeness | 1 - negligible | 무시할 수 있는 확률로 실패 가능 |

대부분의 실용적 ZKP 시스템은 Perfect Completeness를 목표로 한다.

---

## 2. Soundness (건전성)

### 2.1 정의

건전성은 "악의적인 증명자가 거짓 명제에 대해 검증자를 속일 수 없다"는 속성이다.

```
수학적 표현:
만약 x가 언어 L에 속하지 않는다면,
어떤 악의적인 P*도 V를 속여 Accept를 출력하게 만들 확률이 무시할 수 있을 정도로 작다.

Pr[V(x, P*(x)) = Accept | x not in L] <= negligible
```

### 2.2 직관적 이해

- 거짓말쟁이는 자신의 거짓 주장을 증명할 수 없어야 한다
- 시스템은 위조된 증명을 거부해야 한다
- 거짓 음성(false negative acceptance)이 없어야 한다

### 2.3 예시

```
시나리오: 자산 증명

- Bob은 100 ETH를 가지고 있다고 주장하지만, 실제로는 10 ETH만 가지고 있다
- Bob이 어떤 방법을 사용하더라도, 100 ETH 보유 증명을 생성할 수 없어야 한다

건전성 위반 예시:
- 암호학적 약점을 이용해 가짜 증명을 생성할 수 있는 경우
- 해시 충돌을 이용해 잘못된 값을 증명하는 경우
```

### 2.4 Soundness의 종류

| 유형 | 공격자 능력 | 보안 수준 |
|------|-------------|-----------|
| Computational Soundness | 다항 시간 계산 능력 | 계산적으로 안전 |
| Statistical Soundness | 무제한 계산 능력 | 정보 이론적으로 안전 |
| Perfect Soundness | 무제한 계산 능력, 성공 확률 = 0 | 완벽하게 안전 |

#### Knowledge Soundness (지식 건전성)

일반 건전성보다 강력한 속성으로, "증명자가 유효한 증명을 생성할 수 있다면, 실제로 witness를 알고 있다"는 것을 보장한다.

```
Knowledge Soundness 정의:
유효한 증명을 생성할 수 있는 모든 증명자 P*에 대해,
P*로부터 witness w를 추출할 수 있는 효율적인 Extractor E가 존재한다.
```

이 속성은 zkSNARK에서 특히 중요하며, "Proof of Knowledge"라고도 불린다.

---

## 3. Zero-Knowledge (영지식성)

### 3.1 정의

영지식성은 "검증자가 증명 과정에서 명제가 참이라는 사실 외에는 어떠한 추가 정보도 얻지 못한다"는 속성이다.

```
수학적 표현:
검증자 V의 관점에서 본 증명 transcript가
simulator S에 의해 생성된 것과 구분 불가능하다.

모든 V*에 대해, P와의 상호작용을 시뮬레이션하는 S가 존재하여:
View_V*(P(x,w) <-> V*(x)) ≈ S(x)
```

### 3.2 직관적 이해

- 검증자는 "참/거짓" 외에 아무것도 배우지 못한다
- 증명 과정이 비밀 정보를 누출하지 않는다
- 시뮬레이터가 실제 증명과 구분 불가능한 가짜 transcript를 만들 수 있다

### 3.3 예시

```
시나리오: 나이 증명

- Alice는 자신이 18세 이상임을 증명하고 싶다
- 실제 생년월일은 1995년 3월 15일이다

Zero-Knowledge 증명:
- 검증자는 "Alice가 18세 이상이다"만 알게 된다
- 정확한 생년월일, 나이, 주민등록번호 등은 알 수 없다

Non-Zero-Knowledge 증명:
- 검증자에게 주민등록증을 보여준다
- 검증자는 나이 외에도 이름, 주소, 사진 등을 알게 된다
```

### 3.4 Zero-Knowledge의 종류

| 유형 | 구분 능력 | 보안 수준 | 설명 |
|------|-----------|-----------|------|
| Perfect ZK | 어떤 구분자도 구분 불가 | 가장 강력 | 분포가 완벽히 동일 |
| Statistical ZK | 무제한 계산으로도 구분 불가 | 강력 | 통계적 거리가 negligible |
| Computational ZK | 효율적 알고리즘으로 구분 불가 | 실용적 | 계산적으로 구분 불가 |

### 3.5 Simulator 패러다임

Zero-Knowledge를 증명하는 핵심 도구는 Simulator이다.

```
Simulator의 역할:
1. Simulator S는 witness w를 모른다
2. S는 오직 공개 입력 x만 알고 있다
3. S는 실제 증명 transcript와 "구분 불가능한" 가짜 transcript를 생성한다

만약 이러한 S가 존재한다면:
- 실제 증명에서 얻을 수 있는 모든 정보는 S도 생성할 수 있다
- 따라서 실제 증명에서 "추가 정보"는 없다
- 이것이 Zero-Knowledge 속성이다
```

---

## 4. 세 속성의 관계

### 4.1 균형과 트레이드오프

```
                    Completeness
                         /\
                        /  \
                       /    \
                      /      \
                     /   ZKP  \
                    /          \
                   /____________\
            Soundness        Zero-Knowledge
```

세 속성은 서로 긴장 관계에 있을 수 있다:

| 관계 | 설명 |
|------|------|
| Completeness vs Soundness | 너무 관대하면 가짜 증명이 통과, 너무 엄격하면 정당한 증명이 거부 |
| Soundness vs Zero-Knowledge | 검증자에게 더 많은 정보를 주면 검증이 쉬워지지만 프라이버시 감소 |
| Completeness vs Zero-Knowledge | 완벽한 ZK를 위해 복잡한 프로토콜이 필요할 수 있음 |

### 4.2 속성 요약 표

| 속성 | 보호 대상 | 공격자 | 보장 내용 |
|------|-----------|--------|-----------|
| Completeness | 정직한 증명자 | 시스템 오류 | 참인 명제는 증명 가능 |
| Soundness | 정직한 검증자 | 악의적 증명자 | 거짓 명제는 증명 불가 |
| Zero-Knowledge | 정직한 증명자 | 악의적 검증자 | 추가 정보 누출 없음 |

---

## 5. 수학적 형식화

### 5.1 언어와 관계

```
NP 언어 L과 관계 R을 정의:

L = {x : ∃w such that R(x, w) = 1}

여기서:
- x는 공개 입력 (statement)
- w는 비밀 입력 (witness)
- R은 다항 시간 검증 가능한 관계
```

### 5.2 Interactive Proof System

```
Interactive Proof System (P, V)에서:

1. Completeness:
   ∀x ∈ L, ∀w such that R(x,w)=1:
   Pr[<P(x,w), V(x)> = 1] >= 1 - ε_c

2. Soundness:
   ∀x ∉ L, ∀P*:
   Pr[<P*(x), V(x)> = 1] <= ε_s

3. Zero-Knowledge:
   ∀V*, ∃ PPT Simulator S:
   {View_V*(x,w)}_{x∈L} ≈ {S(x)}_{x∈L}

여기서:
- ε_c, ε_s는 negligible function
- PPT = Probabilistic Polynomial Time
- ≈ 는 computational/statistical indistinguishability
```

---

## 6. 실제 프로토콜에서의 적용

### 6.1 zkSNARK에서의 속성

```
zkSNARK (Zero-Knowledge Succinct Non-Interactive Argument of Knowledge):

- Completeness: 정직한 prover의 증명은 항상 검증 통과
- Computational Soundness: 악의적 prover는 계산적으로 가짜 증명 생성 불가
- Zero-Knowledge: Verifier는 witness에 대해 아무것도 학습하지 않음
- Succinctness: 증명 크기가 작고 검증이 빠름 (추가 속성)
- Non-Interactive: 한 번의 메시지로 증명 완료 (추가 속성)
```

### 6.2 zkSTARK에서의 속성

```
zkSTARK (Zero-Knowledge Scalable Transparent Argument of Knowledge):

- Completeness: 동일
- Statistical Soundness: 무제한 계산 능력으로도 가짜 증명 불가 (더 강력)
- Zero-Knowledge: 동일
- Transparency: Trusted Setup 불필요 (추가 속성)
- Scalability: 증명 생성이 quasi-linear time (추가 속성)
```

---

## 7. 연습 문제

### 문제 1: Completeness 이해
```
Q: 다음 시스템이 Completeness를 만족하는가?

시스템: Hash 기반 비밀번호 검증
- 사용자가 비밀번호 P를 입력
- 시스템이 H(P) == stored_hash 확인
- 단, 시스템 시계가 오후 2시-3시 사이면 모든 검증 거부

A: Completeness 위반. 정직한 사용자가 올바른 비밀번호를 입력해도
   시간에 따라 거부될 수 있다.
```

### 문제 2: Soundness 이해
```
Q: 다음 시스템이 Soundness를 만족하는가?

시스템: 단순 서명 검증
- 공개키 pk, 비밀키 sk
- 서명 σ = Sign(sk, m)
- 검증: Verify(pk, m, σ)
- 단, 서명 알고리즘에 백도어가 있어 특정 값 m*에 대해
  sk 없이도 유효한 서명 생성 가능

A: Soundness 위반. 악의적 증명자가 sk를 모르면서도
   m*에 대한 유효한 서명(증명)을 생성할 수 있다.
```

### 문제 3: Zero-Knowledge 이해
```
Q: 다음 증명 방식이 Zero-Knowledge인가?

방식: 비밀번호 직접 전송
- Alice가 Bob에게 비밀번호를 직접 보여줌
- Bob이 해시값과 비교하여 확인

A: Zero-Knowledge 아님. Bob은 "Alice가 비밀번호를 안다"는 사실 외에도
   비밀번호 자체를 알게 된다. Simulator가 실제 비밀번호 없이
   이 상호작용을 시뮬레이션할 수 없다.
```

---

## 8. 참고 자료

### 학술 자료
- Goldwasser, Micali, Rackoff (1985) - "The Knowledge Complexity of Interactive Proof Systems"
- Goldreich, Micali, Wigderson (1991) - "Proofs that Yield Nothing But Their Validity"

### 온라인 자료
- https://github.com/matter-labs/awesome-zero-knowledge-proofs
- https://zkp.science - ZKP 연구 커뮤니티
- https://zkhack.dev - ZK 학습 플랫폼

---

## 요약

```
ZKP의 세 가지 핵심 속성:

1. Completeness (완전성)
   - 참인 명제는 항상 증명 가능
   - 정직한 증명자 보호

2. Soundness (건전성)
   - 거짓 명제는 증명 불가
   - 정직한 검증자 보호

3. Zero-Knowledge (영지식성)
   - 증명 과정에서 추가 정보 누출 없음
   - 증명자의 비밀 보호

이 세 속성이 모두 만족될 때, 진정한 Zero-Knowledge Proof 시스템이 된다.
```
